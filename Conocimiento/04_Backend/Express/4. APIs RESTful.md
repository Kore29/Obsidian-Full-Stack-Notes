#express #js #backend

## ¬øQu√© es una API RESTful?

REST (Representational State Transfer) es un estilo arquitect√≥nico para dise√±ar servicios web escalables y f√°ciles de mantener. Una **API RESTful** sigue principios como:

- Uso de recursos identificados mediante URLs.
- Comunicaci√≥n sin estado (stateless).
- Uso de m√©todos HTTP est√°ndar (`GET`, `POST`, `PUT`, `DELETE`, etc.).
- Respuestas en formatos comunes como JSON o XML.

Express es ideal para construir APIs RESTful gracias a su simplicidad y flexibilidad.

---

## M√©todos HTTP Comunes en APIs REST

| M√©todo   | Uso |
|----------|-----|
| GET      | Recuperar datos (lectura) |
| POST     | Crear nuevos recursos |
| PUT      | Actualizar un recurso completo |
| PATCH    | Actualizar parcialmente un recurso |
| DELETE   | Eliminar un recurso |

### Ejemplo b√°sico de rutas RESTful

```js
// Obtener todos los usuarios
app.get('/api/users', (req, res) => {
  res.json([{ id: 1, name: 'Carlos' }]);
});

// Crear un nuevo usuario
app.post('/api/users', (req, res) => {
  res.status(201).json({ message: 'Usuario creado' });
});

// Obtener un usuario espec√≠fico
app.get('/api/users/:id', (req, res) => {
  const userId = req.params.id;
  res.json({ id: userId, name: 'Carlos' });
});

// Actualizar un usuario
app.put('/api/users/:id', (req, res) => {
  res.json({ message: `Usuario ${req.params.id} actualizado` });
});

// Eliminar un usuario
app.delete('/api/users/:id', (req, res) => {
  res.json({ message: `Usuario ${req.params.id} eliminado` });
});
```

---

## C√≥digos de Estado HTTP M√°s Usados

Los c√≥digos de estado indican el resultado de una solicitud HTTP. Es importante usarlos correctamente para que los clientes entiendan qu√© ocurri√≥.

| C√≥digo | Significado |
|--------|-------------|
| 200    | OK ‚Äì Solicitud exitosa |
| 201    | Created ‚Äì Recurso creado exitosamente |
| 204    | No Content ‚Äì Solicitud exitosa pero sin respuesta |
| 400    | Bad Request ‚Äì Datos inv√°lidos |
| 401    | Unauthorized ‚Äì Necesita autenticaci√≥n |
| 403    | Forbidden ‚Äì Acceso denegado |
| 404    | Not Found ‚Äì Recurso no encontrado |
| 500    | Internal Server Error ‚Äì Error del servidor |

### Ejemplo de uso en Express

```js
app.get('/api/users/:id', (req, res) => {
  const userId = req.params.id;

  if (userId <= 0) {
    return res.status(400).json({ error: 'ID inv√°lido' });
  }

  // Simulamos que no encontramos al usuario
  if (userId > 100) {
    return res.status(404).json({ error: 'Usuario no encontrado' });
  }

  res.json({ id: userId, name: 'Carlos' });
});
```

---

## Convenciones Comunes en APIs RESTful

Para mantener consistencia y facilidad de uso, las APIs RESTful deben seguir ciertas convenciones:

### 1. Nombres de recursos en plural
Usa sustantivos en plural para representar colecciones de recursos:
- ‚úÖ `/api/users`
- ‚ùå `/api/user`

### 2. Rutas anidadas cuando sea necesario
Si hay relaciones entre recursos:
- ‚úÖ `/api/users/123/posts`
- ‚ùå `/api/getPostsByUser?userId=123`

### 3. Usa versiones en tus APIs
Permite hacer cambios sin romper aplicaciones existentes:
- `/api/v1/users`
- `/api/v2/users`

### 4. Paginaci√≥n y filtros
Usa par√°metros de consulta para paginar o filtrar resultados:
- `/api/users?page=2&limit=10`
- `/api/users?role=admin`

---

## Documentar una API

La documentaci√≥n es clave para que otros desarrolladores puedan consumir tu API f√°cilmente. Incluye:

- Descripci√≥n de cada endpoint.
- M√©todos HTTP permitidos.
- Par√°metros esperados.
- Ejemplos de solicitudes y respuestas.
- C√≥digos de estado posibles.

### Herramientas para documentar APIs

#### üîπ Swagger / OpenAPI

Swagger es una herramienta muy usada para documentar APIs RESTful. Permite generar una interfaz interactiva donde probar endpoints directamente desde el navegador.

Ejemplo de instalaci√≥n:

```bash
npm install swagger-jsdoc swagger-ui-express
```

Uso b√°sico:

```js
const swaggerJsDoc = require('swagger-jsdoc');
const swaggerUi = require('swagger-ui-express');

const options = {
  definition: {
    openapi: '3.0.0',
    info: {
      title: 'API de Usuarios',
      version: '1.0.0',
    },
    servers: [
      { url: 'http://localhost:3000/api/v1' }
    ]
  },
  apis: ['./routes/*.js'],
};

const specs = swaggerJsDoc(options);
app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(specs));
```

Con esto, podr√°s acceder a la documentaci√≥n en `/api-docs`.

#### üîπ API Blueprint

Es otra opci√≥n popular, especialmente √∫til si prefieres escribir documentaci√≥n manualmente. Se puede visualizar con herramientas como [Apiary](https://apiary.io).

Ejemplo de documento `.apib`:

```apib
# Grupo Usuarios

## Usuario [/api/users/{id}]

### Obtener Usuario [GET]
+ Response 200 (application/json)
  + Body
    {
      "id": 1,
      "name": "Carlos"
    }
```

---